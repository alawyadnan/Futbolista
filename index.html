<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Futbolista</title>
  <link rel="stylesheet" href="./styles.css?v=90001" />
</head>
<body>

<header class="topbar">
  <div class="brand">
    <div class="appicon">⚽</div>
    <div class="brandtxt">
      <div class="title">Futbolista</div>
    </div>
  </div>

  <div class="row">
    <!-- ✅ onclick مباشر (حل نهائي ضد refresh/submit) -->
    <button id="btnAdminLogin"
            type="button"
            class="btn ghost"
            onclick="event.preventDefault(); event.stopPropagation(); window.__adminLogin?.(); return false;">
      Admin Login
    </button>

    <button id="btnExportTop"
            type="button"
            class="btn ghost"
            data-admin="1"
            onclick="event.preventDefault(); event.stopPropagation(); window.__exportNow?.(); return false;">
      Export
    </button>
  </div>
</header>

<main class="app">

  <!-- DASHBOARD -->
  <section id="screen-dashboard" class="screen">
    <div class="card">
      <div class="card-h">
        <div class="card-title">Top Scorers (Top 3)</div>
      </div>
      <div id="dashTopScorers" class="list note">No data yet.</div>
    </div>

    <div class="card">
      <div class="card-h">
        <div class="card-title">Best Current Streak (Top 3)</div>
      </div>
      <div id="dashTopStreaks" class="list note">No data yet.</div>
    </div>

    <div class="card">
      <div class="card-h">
        <div>
          <div class="card-title">Best Win % (Top 3)</div>
          <div class="subnote">Minimum 2 matches</div>
        </div>
      </div>
      <div id="dashTopWinPct" class="list note">Need at least 2 matches per player.</div>
    </div>

    <div class="grid2">
      <div class="mini">
        <div class="mini-label">Players</div>
        <div id="kpiPlayers" class="mini-value">0</div>
      </div>
      <div class="mini">
        <div class="mini-label">Total Match Entries</div>
        <div id="kpiLogs" class="mini-value">0</div>
      </div>
    </div>
  </section>

  <!-- LEADERBOARD -->
  <section id="screen-leaderboard" class="screen hidden">
    <div class="card">
      <div class="card-h">
        <div class="card-title">Leaderboard</div>
        <div class="row">
          <label class="label">Sort by</label>
          <select id="lbSort" class="select">
            <option value="winPct" selected>Win %</option>
            <option value="goals">Goals</option>
            <option value="gpm">Goals per Match</option>
            <option value="wins">Wins</option>
            <option value="matches">Matches</option>
            <option value="curStreak">Current Win Streak</option>
            <option value="bestStreak">Best Win Streak</option>
          </select>
        </div>
      </div>
      <div id="leaderboardList" class="list note">No players yet.</div>
    </div>
  </section>

  <!-- TABLE -->
  <section id="screen-table" class="screen hidden">
    <div class="card">
      <div class="card-h">
        <div class="card-title">All Players Table</div>
        <div class="row">
          <label class="label">Sort by</label>
          <select id="tableSort" class="select">
            <option value="winPct" selected>Win %</option>
            <option value="goals">Goals</option>
            <option value="gpm">Goals per Match</option>
            <option value="wins">Wins</option>
            <option value="matches">Matches</option>
            <option value="curStreak">Current Win Streak</option>
            <option value="bestStreak">Best Win Streak</option>
            <option value="name">Name</option>
          </select>
        </div>
      </div>

      <div class="tablewrap">
        <table class="table">
          <thead>
            <tr>
              <th>#</th>
              <th>Name</th>
              <th>Matches</th>
              <th>Wins</th>
              <th>Goals</th>
              <th>Win %</th>
              <th>Goals/Match</th>
              <th>Current Streak</th>
              <th>Best Streak</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr><td colspan="9" class="noteCell">No players yet.</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- PLAYERS (ADMIN ONLY) -->
  <section id="screen-players" class="screen hidden" data-admin="1">
    <div class="card">
      <div class="card-title">Add Player</div>
      <div class="row">
        <input id="playerName" class="input" placeholder="Player name (e.g., Ahmed)" />
        <button id="btnAddPlayer" type="button" class="btn">Add</button>
      </div>
    </div>

    <div class="card">
      <div class="card-title">Players</div>
      <div id="playersList" class="list note">No players yet.</div>
    </div>
  </section>

  <!-- MATCHES (ADMIN ONLY) -->
  <section id="screen-matches" class="screen hidden" data-admin="1">
    <div class="card">
      <div class="card-title">Add Match Entry (per player)</div>

      <div class="gridForm">
        <div>
          <div class="label">Date</div>
          <input id="logDate" class="input" type="date" />
        </div>
        <div>
          <div class="label">Player</div>
          <select id="logPlayer" class="select"></select>
        </div>
        <div>
          <div class="label">Goals</div>
          <input id="logGoals" class="input" type="number" min="0" max="99" value="0"/>
        </div>
        <div>
          <div class="label">Result</div>
          <select id="logWin" class="select">
            <option value="win" selected>Win</option>
            <option value="loss">Loss</option>
          </select>
        </div>
      </div>

      <button id="btnAddLog" type="button" class="btn full">Add Entry</button>
    </div>

    <div class="card">
      <div class="card-title">Recent Entries</div>
      <div id="logsList" class="list note">No entries yet.</div>
    </div>
  </section>

  <!-- SETTINGS (ADMIN ONLY) -->
  <section id="screen-settings" class="screen hidden" data-admin="1">
    <div class="card">
      <div class="card-title">Backup / Restore</div>
      <div class="row">
        <button id="btnExport" type="button" class="btn">Export JSON</button>
        <label class="btn ghost filebtn">
          Import JSON (Replace)
          <input id="fileImport" type="file" accept="application/json" hidden />
        </label>
      </div>
    </div>

    <div class="card danger">
      <div class="card-title">Danger Zone</div>
      <button id="btnReset" type="button" class="btn dangerBtn full">Reset all data</button>
    </div>
  </section>

</main>

<!-- ✅ Bottom Tabs -->
<nav class="bottomnav">
  <div class="bottomnav-inner">
    <button type="button" class="navbtn active" data-nav="dashboard">Dashboard</button>
    <button type="button" class="navbtn" data-nav="leaderboard">Leaderboard</button>
    <button type="button" class="navbtn" data-nav="table">Table</button>

    <button type="button" class="navbtn" data-nav="players" data-admin="1">Players</button>
    <button type="button" class="navbtn" data-nav="matches" data-admin="1">Matches</button>
    <button type="button" class="navbtn" data-nav="settings" data-admin="1">Settings</button>
  </div>
</nav>

<script type="module" src="./app.js?v=90001"></script>
</body>
</html>
